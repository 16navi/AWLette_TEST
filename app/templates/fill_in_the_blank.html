{% include 'nav.html' %}

<!-- Styling for table -->
<style>
    table, th, td {
      border:1px solid black;
      height: 30px;
    }

    table {
        display: inline-table;
    }

    form {
        margin-block-end: 0em;
    }
</style>

<!-- While there is no value for 'sublist' -->
{% if not sublist %}

Choose a sublist:
<form action='{{url_for('fill_in_the_blank')}}' method='GET'>
    <ul>
        <li><button name='sublist' type='submit' id='sublist_button' value='1'>Sublist 1</button></li>
    </ul>
</form>

{% endif %}

<!-- When 'sublist' has value -->
{% if sublist %}

<p>You picked Sublist No.{{ sublist }}</p>

<!-- List the forms in a seperate table as choices for 
 filling in the blanks in the sentence -->
<table>
    <tr>
        <th>Choices</th>
    </tr>
    {% for form in random_forms|shuffle %}
    <tr>
        <td>{{ form|capitalize }}</td>
    </tr>
    {% endfor %}
</table>

<!-- Lists the sentences with input fields in between -->
<table>
    <tr>
        <th>Fill in the Blanks</th>
    </tr>
    {% for form in random_forms %}
    <tr>    
         <td>
            <!-- I used Jinja to basically replace the 'form' inside the sentence
            with a text input field -->

            <!-- Set empty lists for the two sentence blocks -->
            {% set sentence_blanked1 = [] %}
            {% set sentence_blanked2 = [] %}          

                <!-- For loop to add each word of the sentence to their respective blocks -->
                {% for word in (form.sentence|lower).split() %}

                    <!-- if word is not the same as form and the last item in sentence_blanked1
                     is not False, do the following -->
                    {% if word|lower != form.form|lower and sentence_blanked1[-1] != False %}
                        {{ sentence_blanked1.append(word) or "" }}

                    <!-- Else, if word is the same as form -->
                    {% elif word|lower == form|lower %}
                        {{ sentence_blanked1.append(False) or "" }}
                    {% endif %}

                    <!-- If word is not the same as form and the last item in sentence_blanked1
                     is False, do the following -->
                    {% if word|lower != form.form|lower and sentence_blanked1[-1] == False %}
                        {{ sentence_blanked2.append(word) or "" }}
                    {% endif %}
                {% endfor %}

                <!-- Remove the False item in the list -->
                {{ sentence_blanked1.pop(-1) or "" }}

                {{ sentence_blanked1|join(' ')|capitalize }} 
                <input type='text' id='{{ loop.index }}' style='text-align: center'></input> 
                {{ sentence_blanked2|join(' ') }}

                <!-- Change the sentences where there are suffixes
                 and prefixes to the word because it doesn't work
                well with the code -->
            </td>
    </tr>
    {% endfor %}
</table>

{% endif %}

<!-- If I can turn this into a function that would be great -->
<script>
    // for input field 1
    const answer1 = document.getElementById('1');
    answer1.addEventListener('keyup', function(event) {
        if (event.key === 'Enter') {
            alert('1 - You pressed the Enter key!');
        }
    });
    
    // for input field 2
    const answer2 = document.getElementById('2');
    answer2.addEventListener('keyup', function(event) {
        if (event.key === 'Enter') {
            alert('2 - You pressed the Enter key!');
        }
    });
    // for input field 3
    const answer3 = document.getElementById('3');
    answer3.addEventListener('keyup', function(event) {
        if (event.key === 'Enter') {
            alert('3 - You pressed the Enter key!');
        }
    });
    // for input field 4
    const answer4 = document.getElementById('4');
    answer4.addEventListener('keyup', function(event) {
        if (event.key === 'Enter') {
            alert('4 - You pressed the Enter key!');
        }
    });
    // for input field 5
    const answer5 = document.getElementById('5');
    answer5.addEventListener('keyup', function(event) {
        if (event.key === 'Enter') {
            alert('5 - You pressed the Enter key!');
        }
    });

</script>